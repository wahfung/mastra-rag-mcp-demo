# Mastra RAG Demo

ä¸€ä¸ªä½¿ç”¨ **çº¯ Mastra æ¡†æ¶** æ„å»ºçš„ RAG (Retrieval-Augmented Generation) æ¼”ç¤ºé¡¹ç›®ï¼Œå±•ç¤ºäº†å¦‚ä½•ç”¨å•ä¸€æ¡†æ¶å®ç°æ™ºèƒ½é—®ç­”å’Œæ–‡æ¡£ç®¡ç†ã€‚

## âœ¨ è®¾è®¡ç†å¿µ

**ç®€æ´ > å¤æ‚** - é¿å…é‡å¤å®ç°ï¼Œå……åˆ†åˆ©ç”¨ Mastra çš„å†…ç½®åŠŸèƒ½

- ğŸ¯ **Pure Mastra** - æ— å†—ä½™ä¾èµ–ï¼Œçº¯ Mastra ç”Ÿæ€
- ğŸ”§ **é›¶é…ç½® MCP** - é€šè¿‡ REST API æä¾›ç±» MCP åŠŸèƒ½
- ğŸ“¦ **æœ€å°ä¾èµ–** - åªåŒ…å«å¿…è¦çš„åŒ…
- ğŸš€ **å¼€ç®±å³ç”¨** - ç®€åŒ–é…ç½®ï¼Œå¿«é€Ÿå¯åŠ¨

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- ğŸ” **æ™ºèƒ½é—®ç­”** - åŸºäºæ–‡æ¡£çŸ¥è¯†åº“çš„ RAG æŸ¥è¯¢
- ğŸ“„ **æ–‡æ¡£ç®¡ç†** - åŠ¨æ€æ·»åŠ å’Œç´¢å¼•æ–‡æ¡£  
- ğŸ› ï¸ **å·¥å…·æ¥å£** - RESTful å·¥å…·è°ƒç”¨ API
- ğŸŒ **Web å…¼å®¹** - ä¼ ç»Ÿ HTTP æ¥å£
- ğŸ“Š **å‘é‡æœç´¢** - é«˜æ•ˆçš„è¯­ä¹‰æœç´¢

## ğŸ—ï¸ ç®€åŒ–æ¶æ„

```
              å‰ç«¯åº”ç”¨/å·¥å…·
                   â”‚
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Express API   â”‚
            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
            â”‚  â”‚   /query  â”‚  â”‚ â—„â”€â”€â”€ REST API
            â”‚  â”‚ /documentsâ”‚  â”‚
            â”‚  â”‚  /tools   â”‚  â”‚ â—„â”€â”€â”€ å·¥å…·æ¥å£ (ç±» MCP)
            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Mastra Core    â”‚
            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
            â”‚  â”‚å·¥å…·ç®¡ç†å™¨ â”‚  â”‚
            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
            â”‚  â”‚ RAGå¼•æ“   â”‚  â”‚
            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/wahfung/mastra-rag-mcp-demo.git
cd mastra-rag-mcp-demo
```

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. ç¯å¢ƒé…ç½®

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
OPENAI_API_KEY=your_openai_api_key
VECTOR_DB_URL=your_vector_db_url  # å¯é€‰ï¼Œå¦‚æœ Mastra å†…ç½®å‘é‡æ•°æ®åº“
PORT=3000
```

### 4. å¯åŠ¨æœåŠ¡

```bash
npm run dev
```

## ğŸ“¡ API ä½¿ç”¨æŒ‡å—

### åŸºç¡€ç«¯ç‚¹

#### å¥åº·æ£€æŸ¥
```bash
curl http://localhost:3000/health
```

#### æ™ºèƒ½é—®ç­”
```bash
curl -X POST http://localhost:3000/query \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"question\": \"ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½?\"}'
```

#### æ·»åŠ æ–‡æ¡£
```bash
curl -X POST http://localhost:3000/documents \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"content\": \"äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯...\",\n    \"metadata\": {\"title\": \"AIåŸºç¡€\", \"author\": \"Demo\"}\n  }'
```

### å·¥å…·æ¥å£ (ç±» MCP)

#### è·å–å¯ç”¨å·¥å…·
```bash
curl http://localhost:3000/tools
```

å“åº”ï¼š
```json
{
  \"tools\": [
    {
      \"name\": \"query_knowledge\",
      \"description\": \"æŸ¥è¯¢çŸ¥è¯†åº“\",
      \"inputSchema\": { ... }
    },
    {
      \"name\": \"add_document\", 
      \"description\": \"æ·»åŠ æ–‡æ¡£åˆ°çŸ¥è¯†åº“\",
      \"inputSchema\": { ... }
    }
  ]
}
```

#### è°ƒç”¨å·¥å…·
```bash
curl -X POST http://localhost:3000/tools/query_knowledge \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"question\": \"æœºå™¨å­¦ä¹ æ˜¯ä»€ä¹ˆ?\"}'
```

## ğŸ”§ æ ¸å¿ƒé…ç½®

### Mastra å·¥å…·å®šä¹‰

```typescript
const mastra = new Mastra({
  tools: [
    {
      name: 'query_knowledge',
      description: 'æŸ¥è¯¢çŸ¥è¯†åº“',
      inputSchema: {
        type: 'object',
        properties: {
          question: { type: 'string', description: 'è¦æŸ¥è¯¢çš„é—®é¢˜' }
        },
        required: ['question']
      },
      execute: async ({ question }) => {
        // RAG æŸ¥è¯¢é€»è¾‘
      }
    }
  ],
  engines: {
    rag: new RAGEngine({
      // RAG é…ç½®
    })
  }
});
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
mastra-rag-demo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # ä¸»åº”ç”¨ (çº¯ Mastra + Express)
â”‚   â””â”€â”€ setup-vectordb.ts     # å‘é‡æ•°æ®åº“åˆå§‹åŒ– (å¯é€‰)
â”œâ”€â”€ package.json              # æœ€å°åŒ–ä¾èµ–
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â”œâ”€â”€ .env.example             # ç¯å¢ƒå˜é‡
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸ†š æ¶æ„å¯¹æ¯”

### âŒ ä¹‹å‰çš„å¤æ‚æ–¹æ¡ˆ
```
Mastra + ç‹¬ç«‹MCPæœåŠ¡å™¨ + RAGæœåŠ¡ + Express
= å¤šä¸ªæœåŠ¡ + é‡å¤ä»£ç  + @modelcontextprotocol/sdk ä¾èµ–
```

### âœ… ç°åœ¨çš„ç®€æ´æ–¹æ¡ˆ  
```
Mastra Core + Express åŒ…è£…
= å•ä¸€æœåŠ¡ + é›¶å†—ä½™ + çº¯ Mastra ç”Ÿæ€
```

## ğŸ› ï¸ æ ¸å¿ƒä¾èµ–

```json
{
  \"dependencies\": {
    \"@mastra/core\": \"^0.1.0\",
    \"@mastra/rag\": \"^0.1.0\", 
    \"@mastra/vector-db\": \"^0.1.0\",
    \"openai\": \"^4.0.0\",
    \"express\": \"^4.18.0\",
    \"cors\": \"^2.8.0\",
    \"dotenv\": \"^16.0.0\"
  }
}
```

**æ³¨æ„**: å®Œå…¨ç§»é™¤äº† `@modelcontextprotocol/sdk` ä¾èµ–ï¼

## ğŸ”® æ‰©å±•æ–¹å‘

- [ ] æ”¯æŒæ›´å¤š LLM æ¨¡å‹
- [ ] æ–‡ä»¶ä¸Šä¼ å’Œè§£æ (PDF/Word)
- [ ] æ‰¹é‡æ–‡æ¡£å¤„ç†
- [ ] æŸ¥è¯¢ç»“æœç¼“å­˜
- [ ] WebSocket å®æ—¶é€šä¿¡

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å……åˆ†åˆ©ç”¨ Mastra ç”Ÿæ€** - é¿å…é‡å¤é€ è½®å­
2. **ç®€åŒ–ä¾èµ–æ ‘** - åªæ·»åŠ å¿…è¦çš„åŒ…
3. **ç»Ÿä¸€å·¥å…·ç®¡ç†** - é€šè¿‡ Mastra å·¥å…·ç³»ç»Ÿç®¡ç†æ‰€æœ‰åŠŸèƒ½
4. **RESTful è®¾è®¡** - æä¾›æ¸…æ™°çš„ API æ¥å£

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issues å’Œ Pull Requestsï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æ ¸å¿ƒç†å¿µ: Less is More - ç”¨ Mastra å®ç°æ›´ç®€æ´çš„ RAG åº”ç”¨ï¼** ğŸš€