# Mastra RAG Demo

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Mastra æ¡†æ¶æ„å»ºçš„ RAG (Retrieval-Augmented Generation) æ¼”ç¤ºé¡¹ç›®ï¼Œå±•ç¤ºäº†å¦‚ä½•è½»æ¾é›†æˆæ™ºèƒ½é—®ç­”å’Œæ–‡æ¡£ç®¡ç†åŠŸèƒ½ã€‚

## âœ¨ ä¸ºä»€ä¹ˆé€‰æ‹© Mastraï¼Ÿ

- ğŸ¯ **ç»Ÿä¸€æ¡†æ¶** - ä¸€ä¸ªæ¡†æ¶è§£å†³ RAG + MCP + å·¥å…·ç®¡ç†
- ğŸ”Œ **å†…ç½® MCP æ”¯æŒ** - æ— éœ€å•ç‹¬å®ç° MCP æœåŠ¡å™¨
- ğŸ› ï¸ **å·¥å…·ç”Ÿæ€** - ä¸°å¯Œçš„é¢„æ„å»ºå·¥å…·å’Œé›†æˆ
- ğŸ“¦ **å¼€ç®±å³ç”¨** - ç®€åŒ–é…ç½®ï¼Œå¿«é€Ÿå¯åŠ¨

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- ğŸ” **æ™ºèƒ½é—®ç­”** - åŸºäºæ–‡æ¡£çŸ¥è¯†åº“çš„ RAG æŸ¥è¯¢
- ğŸ“„ **æ–‡æ¡£ç®¡ç†** - åŠ¨æ€æ·»åŠ å’Œç´¢å¼•æ–‡æ¡£
- ğŸ”Œ **MCP é›†æˆ** - Mastra è‡ªåŠ¨æš´éœ² MCP å…¼å®¹æ¥å£
- ğŸŒ **RESTful API** - ä¼ ç»Ÿ Web åº”ç”¨æ¥å£
- ğŸ“Š **å‘é‡æœç´¢** - é«˜æ•ˆçš„è¯­ä¹‰æœç´¢

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web åº”ç”¨      â”‚    â”‚   AI å·¥å…·       â”‚    â”‚   CLI å·¥å…·      â”‚
â”‚   (REST API)    â”‚    â”‚   (MCP)         â”‚    â”‚   (ç›´æ¥è°ƒç”¨)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚        Mastra Core        â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚    å·¥å…·ç®¡ç†å™¨       â”‚  â”‚
                    â”‚  â”‚ â€¢ query_knowledge   â”‚  â”‚
                    â”‚  â”‚ â€¢ add_document      â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚     RAG å¼•æ“        â”‚  â”‚
                    â”‚  â”‚ â€¢ å‘é‡æ•°æ®åº“        â”‚  â”‚
                    â”‚  â”‚ â€¢ åµŒå…¥æ¨¡å‹          â”‚  â”‚
                    â”‚  â”‚ â€¢ è¯­è¨€æ¨¡å‹          â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/wahfung/mastra-rag-mcp-demo.git
cd mastra-rag-mcp-demo
```

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. ç¯å¢ƒé…ç½®

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
OPENAI_API_KEY=your_openai_api_key
VECTOR_DB_URL=your_vector_db_url
PORT=3000
```

### 4. åˆå§‹åŒ–å‘é‡æ•°æ®åº“

```bash
npm run vector-setup
```

### 5. å¯åŠ¨æœåŠ¡

```bash
npm run dev
```

## ğŸ“¡ API ä½¿ç”¨

### REST API ç«¯ç‚¹

#### å¥åº·æ£€æŸ¥
```bash
curl http://localhost:3000/health
```

#### æ™ºèƒ½é—®ç­”
```bash
curl -X POST http://localhost:3000/query \
  -H "Content-Type: application/json" \
  -d '{"question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½?"}'
```

#### æ·»åŠ æ–‡æ¡£
```bash
curl -X POST http://localhost:3000/documents \
  -H "Content-Type: application/json" \
  -d '{
    "content": "äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œè‡´åŠ›äºåˆ›å»ºèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½çš„ä»»åŠ¡çš„ç³»ç»Ÿã€‚",
    "metadata": {"title": "AIåŸºç¡€", "author": "Demo"}
  }'
```

### MCP å·¥å…·è°ƒç”¨

å¦‚æœ Mastra æ”¯æŒè‡ªåŠ¨ MCP æš´éœ²ï¼Œä½ å¯ä»¥é€šè¿‡ MCP å®¢æˆ·ç«¯è°ƒç”¨ï¼š

```javascript
// é€šè¿‡ MCP å®¢æˆ·ç«¯
const result = await mcpClient.callTool('query_knowledge', {
  question: 'æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ'
});
```

## ğŸ”§ é…ç½®è¯´æ˜

### Mastra å·¥å…·é…ç½®

é¡¹ç›®ä¸­å®šä¹‰äº†ä¸¤ä¸ªä¸»è¦å·¥å…·ï¼š

1. **query_knowledge** - æ™ºèƒ½é—®ç­”
   - è¾“å…¥ï¼š`question` (string)
   - è¾“å‡ºï¼šç­”æ¡ˆã€ç›¸å…³æ¥æºã€å¤„ç†æ—¶é—´

2. **add_document** - æ–‡æ¡£æ·»åŠ 
   - è¾“å…¥ï¼š`content` (string), `metadata` (object)
   - è¾“å‡ºï¼šæ–‡æ¡£IDã€åˆ†å—ä¿¡æ¯

### å‘é‡æ•°æ®åº“æ”¯æŒ

- **Pinecone** (é»˜è®¤) - äº‘ç«¯å‘é‡æ•°æ®åº“
- **Chroma** - å¼€æºå‘é‡æ•°æ®åº“
- **Weaviate** - å‘é‡æœç´¢å¼•æ“
- **Qdrant** - é«˜æ€§èƒ½å‘é‡æ•°æ®åº“

### LLM æ¨¡å‹æ”¯æŒ

- **OpenAI** - GPT-4, GPT-3.5-turbo
- **Claude** - Anthropic æ¨¡å‹
- **Gemini** - Google æ¨¡å‹

## ğŸ†š æ¶æ„å¯¹æ¯”

### âŒ ä¼ ç»Ÿæ–¹æ¡ˆï¼ˆå¤æ‚ï¼‰
```
RAG æœåŠ¡ + ç‹¬ç«‹ MCP æœåŠ¡å™¨ + API æœåŠ¡å™¨
= 3ä¸ªæœåŠ¡ + é‡å¤ä»£ç  + å¤æ‚éƒ¨ç½²
```

### âœ… Mastra æ–¹æ¡ˆï¼ˆç®€æ´ï¼‰
```
Mastra æ ¸å¿ƒ
= 1ä¸ªæœåŠ¡ + ç»Ÿä¸€ç®¡ç† + è‡ªåŠ¨ MCP
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°å·¥å…·

```typescript
// åœ¨ src/index.ts ä¸­æ·»åŠ 
const newTool = {
  name: 'custom_tool',
  description: 'è‡ªå®šä¹‰å·¥å…·æè¿°',
  inputSchema: { /* JSON Schema */ },
  execute: async (params) => {
    // å·¥å…·é€»è¾‘
    return result;
  }
};

mastra.tools.push(newTool);
```

### è‡ªå®šä¹‰ RAG é…ç½®

```typescript
const customRAGEngine = new RAGEngine({
  vectorDB: {
    provider: 'chroma',
    config: { host: 'localhost', port: 8000 }
  },
  embedder: {
    provider: 'huggingface',
    model: 'sentence-transformers/all-MiniLM-L6-v2'
  },
  llm: {
    provider: 'claude',
    model: 'claude-3-sonnet'
  }
});
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
mastra-rag-mcp-demo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # ä¸»åº”ç”¨ï¼ˆMastra + APIï¼‰
â”‚   â””â”€â”€ setup-vectordb.ts     # å‘é‡æ•°æ®åº“åˆå§‹åŒ–
â”œâ”€â”€ package.json              # ç®€åŒ–çš„ä¾èµ–
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â”œâ”€â”€ .env.example             # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: Mastra æ²¡æœ‰è‡ªåŠ¨æš´éœ² MCP ç«¯ç‚¹ï¼Ÿ**
A: æ£€æŸ¥ Mastra ç‰ˆæœ¬ï¼Œæˆ–è€…æ‰‹åŠ¨æ·»åŠ ï¼š
```typescript
if (!mastra.getMCPRouter) {
  console.log('å½“å‰ Mastra ç‰ˆæœ¬ä¸æ”¯æŒè‡ªåŠ¨ MCPï¼Œè¯·æ‰‹åŠ¨å®ç°');
}
```

**Q: å‘é‡æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ**
A: æ£€æŸ¥ `VECTOR_DB_URL` é…ç½®å’Œç½‘ç»œè¿æ¥

**Q: å·¥å…·è°ƒç”¨å¤±è´¥ï¼Ÿ**
A: æ£€æŸ¥å·¥å…·åç§°å’Œå‚æ•°æ ¼å¼æ˜¯å¦æ­£ç¡®

## ğŸ”® æœªæ¥è§„åˆ’

- [ ] æ”¯æŒæ›´å¤šå‘é‡æ•°æ®åº“
- [ ] å¢åŠ æ–‡æ¡£æ ¼å¼æ”¯æŒï¼ˆPDFã€Wordï¼‰
- [ ] å®ç°æŸ¥è¯¢ç¼“å­˜æœºåˆ¶
- [ ] æ·»åŠ ç”¨æˆ·æƒé™ç®¡ç†
- [ ] é›†æˆæ›´å¤š AI æ¨¡å‹

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issues å’Œ Pull Requestsï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**å…³é”®ä¼˜åŠ¿ï¼šä½¿ç”¨ Mastra è®© RAG + MCP é›†æˆå˜å¾—ç®€å•è€Œå¼ºå¤§ï¼** ğŸš€